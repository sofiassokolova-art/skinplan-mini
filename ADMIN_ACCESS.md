# Как попасть в админ-панель

## Шаг 1: Убедитесь, что вы админ в базе данных

Ваш Telegram username должен быть в базе данных как администратор. У вас уже настроен username: `@sofiagguseynova`

Чтобы создать/обновить админа, выполните:
```bash
npm run seed:admin
```

Это создаст админа с username `sofiagguseynova` в базе данных.

## Шаг 2: Откройте страницу входа

**Важно:** Админ-панель использует **Telegram Login Widget**, который работает через **персональные аккаунты Telegram**, а не через Mini App бота.

### Доступ к админ-панели

1. Откройте в браузере: `https://skinplan-mini.vercel.app/admin/login`
2. Или локально: `http://localhost:3000/admin/login`

**Не требуется:** Открывать через Telegram Mini App или бота - виджет работает независимо!

## Шаг 3: Авторизация через Telegram Login Widget

1. На странице `/admin/login` появится кнопка "Войти через Telegram" (Telegram Login Widget)
2. Нажмите на кнопку - откроется окно авторизации Telegram
3. Выберите ваш **персональный Telegram аккаунт** (тот, где username `@sofiagguseynova`)
4. Подтвердите вход
5. Система автоматически проверит ваш Telegram username из персонального аккаунта
6. Если вы админ (`@sofiagguseynova`), вас перенаправит в админ-панель
7. Если нет доступа - получите ошибку "Access denied"

### Настройка Login URL в BotFather (требуется один раз)

Чтобы виджет работал, нужно настроить Login URL в @BotFather:
1. Откройте @BotFather в Telegram
2. Отправьте `/mybots`
3. Выберите вашего бота (`@skinplanned_bot`)
4. Выберите "Payments & Login" → "Login URL"
5. Укажите: `https://skinplan-mini.vercel.app`
6. Сохраните изменения

## Структура админ-панели

После входа вы попадете на:
- **Дашборд**: `/admin` - главная страница админ-панели
- **Продукты**: `/admin/products` - управление продуктами
- **Анкета**: `/admin/questionnaire` - просмотр и редактирование анкеты
- **Правила**: `/admin/rules` - управление правилами рекомендаций

## Отладка проблем

Если у вас не получается войти:

1. Откройте страницу отладки: `/admin/debug`
2. Проверьте:
   - Загрузился ли Telegram Login Widget на странице
   - Видна ли кнопка "Войти через Telegram"
   - Какой ваш Telegram username в персональном аккаунте
   - Существует ли админ в базе данных

3. Убедитесь, что:
   - Вы используете правильный персональный Telegram аккаунт (с username `@sofiagguseynova`)
   - Ваш Telegram username совпадает с тем, что в базе данных (`sofiagguseynova`)
   - Админ создан в базе данных (выполните `npm run seed:admin`)
   - Login URL настроен в BotFather (см. Шаг 3)

4. Если виджет не загружается:
   - Проверьте консоль браузера на ошибки
   - Убедитесь, что домен добавлен в BotFather → Payments & Login → Login URL
   - Попробуйте очистить кеш браузера

## Важно

- **Админ-панель использует Telegram Login Widget - работает в обычном браузере!**
- **Не требуется** открывать через Telegram Mini App или бота
- Авторизация происходит через **персональные аккаунты Telegram** (не через бота)
- Система проверяет ваш Telegram username из персонального аккаунта
- Токен хранится в `localStorage` как `admin_token`
- Для работы виджета нужно настроить Login URL в BotFather (один раз)

## Как добавить нового админа

1. Узнайте Telegram username нового админа (например, `@username`)
2. Добавьте админа в базу данных:
   ```typescript
   // В scripts/seed-admin.ts измените:
   const telegramUsername = 'username'; // Без @
   
   // Затем выполните:
   npm run seed:admin
   ```
3. Новый админ сможет войти через Telegram Login Widget со своим персональным аккаунтом
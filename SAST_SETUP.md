# üîí SAST (Static Application Security Testing) Setup

## –ß—Ç–æ —Ç–∞–∫–æ–µ SAST?

SAST (Static Application Security Testing) - —ç—Ç–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–æ–≥–∞–µ—Ç –Ω–∞–π—Ç–∏ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ **–¥–æ** –¥–µ–ø–ª–æ—è –≤ –ø—Ä–æ–¥–∞–∫—à–Ω.

## ‚úÖ –ß—Ç–æ —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ:

1. **ESLint** - –±–∞–∑–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞
2. **npm audit** - –ø—Ä–æ–≤–µ—Ä–∫–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
3. **–°–∫—Ä–∏–ø—Ç —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Å–µ–∫—Ä–µ—Ç–æ–≤** - –ø–æ–∏—Å–∫ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ –∫–æ–¥–µ
4. **GitHub Actions workflow** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∏ push/PR

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:

### –õ–æ–∫–∞–ª—å–Ω–æ:

```bash
# –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
npm run security:check

# –û—Ç–¥–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:
npm run lint              # ESLint
npm run audit:check       # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
npm run secrets:scan      # –ü–æ–∏—Å–∫ —Å–µ–∫—Ä–µ—Ç–æ–≤
```

### –ü–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º –≤ –ø—Ä–æ–¥:

```bash
# –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º!
npm run security:check
```

## üìã –ß–µ–∫-–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –ø—Ä–æ–¥–∞–∫—à–Ω–æ–º:

- [ ] `npm run security:check` - –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã
- [ ] `npm audit` - –Ω–µ—Ç –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
- [ ] `npm run secrets:scan` - –Ω–µ—Ç —Ä–µ–∞–ª—å–Ω—ã—Ö —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ –∫–æ–¥–µ
- [ ] –í—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –Ω–∞ Vercel
- [ ] `.env` –≤ `.gitignore` (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ!)
- [ ] JWT_SECRET –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (–Ω–µ –¥–µ—Ñ–æ–ª—Ç)
- [ ] DATABASE_URL –Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—Å—è –≤ Git

## ‚ö†Ô∏è –¢–µ–∫—É—â–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:

### 1. –£—è–∑–≤–∏–º–æ—Å—Ç—å –≤ esbuild (moderate)

```bash
npm audit
```

**–†–µ—à–µ–Ω–∏–µ:**
- –û–±–Ω–æ–≤–∏—Ç—å `tsx` –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏ (–µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ)
- –ò–ª–∏ –æ–±–Ω–æ–≤–∏—Ç—å `vercel` CLI (–º–æ–∂–µ—Ç –±—ã—Ç—å breaking change)

**–í–∞–∂–Ω–æ:** –≠—Ç–∞ —É—è–∑–≤–∏–º–æ—Å—Ç—å –≤–ª–∏—è–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ development —Å–µ—Ä–≤–µ—Ä, –Ω–µ –Ω–∞ production build.

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ–∫—Ä–µ—Ç–æ–≤

–°–∫—Ä–∏–ø—Ç `secrets:scan` –Ω–∞–π–¥–µ—Ç –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ–∫—Ä–µ—Ç—ã. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
- –ü—Ä–∏–º–µ—Ä—ã –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ (.md —Ñ–∞–π–ª—ã) - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ
- –†–µ–∞–ª—å–Ω—ã–µ —Å–µ–∫—Ä–µ—Ç—ã –≤ –∫–æ–¥–µ - –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å (–ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤ .env)

## üîß –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è:

### 1. –î–æ–±–∞–≤–∏—Ç—å ESLint –ø–ª–∞–≥–∏–Ω—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):

```bash
npm install --save-dev eslint-plugin-security
```

–ó–∞—Ç–µ–º –≤ `eslint.config.js`:
```js
import security from 'eslint-plugin-security';

export default tseslint.config([
  // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø—Ä–∞–≤–∏–ª–∞
  {
    plugins: {
      security,
    },
    rules: {
      'security/detect-object-injection': 'warn',
      'security/detect-non-literal-fs-filename': 'warn',
      'security/detect-eval-with-expression': 'error',
    },
  },
]);
```

### 2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Snyk (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –±–µ—Å–ø–ª–∞—Ç–Ω–æ):

```bash
npm install -g snyk
snyk test
snyk monitor  # –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
```

### 3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å GitHub Advanced Security (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ):

- Secret scanning (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
- Code scanning (CodeQL)
- Dependency review

## üìù –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ CI/CD:

GitHub Actions workflow —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω (`.github/workflows/security.yml`).

–ü—Ä–æ–≤–µ—Ä–∫–∏ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏:
- Push –≤ `main`, `develop`, `production`
- Pull Request –≤ —ç—Ç–∏ –≤–µ—Ç–∫–∏
- –ï–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 3:00 UTC (–ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é)

## üéØ –ß—Ç–æ –¥–µ–ª–∞—Ç—å –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:

1. **–ö—Ä–∏—Ç–∏—á–Ω—ã–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è—Ö:**
   ```bash
   npm audit fix
   # –ï—Å–ª–∏ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç:
   npm audit fix --force  # –û—Å—Ç–æ—Ä–æ–∂–Ω–æ! –ú–æ–∂–µ—Ç –±—ã—Ç—å breaking change
   ```

2. **–ù–∞–π–¥–µ–Ω —Å–µ–∫—Ä–µ—Ç –≤ –∫–æ–¥–µ:**
   - –£–¥–∞–ª–∏—Ç–µ —Å–µ–∫—Ä–µ—Ç –∏–∑ –∫–æ–¥–∞
   - –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç–µ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
   - –û–±–Ω–æ–≤–∏—Ç–µ —Å–µ–∫—Ä–µ—Ç –≤ Vercel
   - –ï—Å–ª–∏ —Å–µ–∫—Ä–µ—Ç –±—ã–ª –∑–∞–∫–æ–º–º–∏—á–µ–Ω - —Å–º–µ–Ω–∏—Ç–µ –µ–≥–æ!

3. **ESLint –æ—à–∏–±–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:**
   - –ò—Å–ø—Ä–∞–≤—å—Ç–µ —Å–æ–≥–ª–∞—Å–Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º
   - –ï—Å–ª–∏ —ç—Ç–æ false positive - –¥–æ–±–∞–≤—å—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π `// eslint-disable-next-line security/...`

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã:

- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [Next.js Security Best Practices](https://nextjs.org/docs/app/building-your-application/configuring/security-headers)
- [npm audit docs](https://docs.npmjs.com/cli/v10/commands/npm-audit)


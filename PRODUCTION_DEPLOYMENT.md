# Production Deployment Checklist

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –¥–æ—Ä–∞–±–æ—Ç–∫–∏

### 1. Rate Limiting ‚úÖ
- [x] –°–æ–∑–¥–∞–Ω –ø—Ä–æ—Å—Ç–æ–π rate limiter (`lib/rate-limit.ts`)
- [x] –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ middleware –¥–ª—è –∑–∞—â–∏—Ç—ã API
- [x] –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –ª–∏–º–∏—Ç—ã –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö endpoints:
  - `/api/plan/generate`: 10 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É
  - `/api/questionnaire/answers`: 5 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É
  - `/api/recommendations`: 20 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É
  - `/api/admin/login`: 3 –ø–æ–ø—ã—Ç–∫–∏ –∑–∞ 15 –º–∏–Ω—É—Ç (–∑–∞—â–∏—Ç–∞ –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞)

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –î–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω–∞ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Redis-based —Ä–µ—à–µ–Ω–∏–µ (Upstash) –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ rate limiting.

### 2. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ ‚úÖ
- [x] –°–æ–∑–¥–∞–Ω –º–æ–¥—É–ª—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è (`lib/cache.ts`)
- [x] –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–ª–∞–Ω–∞ (15 –º–∏–Ω—É—Ç TTL)
- [x] –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π (30 –º–∏–Ω—É—Ç TTL)
- [x] –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ –≤ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –ø–ª–∞–Ω–∞ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π

**–¢—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏**: –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è Vercel KV:
- `KV_URL`
- `KV_REST_API_URL`
- `KV_REST_API_TOKEN`
- `KV_REST_API_READ_ONLY_TOKEN`

### 3. Error Handling ‚úÖ
- [x] –°–æ–∑–¥–∞–Ω –≥–ª–æ–±–∞–ª—å–Ω—ã–π Error Boundary (`components/ErrorBoundary.tsx`)
- [x] –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ root layout
- [x] –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ API –∫–ª–∏–µ–Ω—Ç–µ (429, 401)

### 4. Toast –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è ‚úÖ
- [x] –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω `react-hot-toast`
- [x] –°–æ–∑–¥–∞–Ω –∫–æ–º–ø–æ–Ω–µ–Ω—Ç Toaster (`components/Toaster.tsx`)
- [x] –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ root layout

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥**: –î–æ–±–∞–≤–∏—Ç—å toast –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—à–∏–±–æ–∫ API.

---

## üìã –û—Å—Ç–∞–≤—à–∏–µ—Å—è –∑–∞–¥–∞—á–∏

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ (–¥–æ 50k MAU)

- [ ] **Rate Limiting —Å Redis** (Upstash)
  - –ú–∏–≥—Ä–∞—Ü–∏—è —Å in-memory –Ω–∞ Redis-based rate limiting
  - –û–±–µ—Å–ø–µ—á–∏—Ç —Ä–∞–±–æ—Ç—É rate limiting –≤ serverless –æ–∫—Ä—É–∂–µ–Ω–∏–∏

- [ ] **–ê–¥–º–∏–Ω–∫–∞ —á–µ—Ä–µ–∑ Telegram Login**
  - –£–±—Ä–∞—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –ø–æ —Å–µ–∫—Ä–µ—Ç–Ω–æ–º—É —Å–ª–æ–≤—É
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Telegram Login Widget + whitelist –≤ –ë–î

- [ ] **–ë–∞–∑–æ–≤—ã–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã**
  - –¢–µ—Å—Ç—ã –¥–ª—è `lib/profile-calculator.ts`
  - –¢–µ—Å—Ç—ã –¥–ª—è `app/api/plan/generate/route.ts`
  - –¢–µ—Å—Ç—ã –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ initData

### –°—Ä–µ–¥–Ω–∏–µ (–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ)

- [ ] **Sentry –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞**
  - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Sentry SDK
  - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤
  - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ Error Boundary

- [ ] **–ú–∏–≥—Ä–∞—Ü–∏—è —Å—Ç–∏–ª–µ–π**
  - –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
  - –ú–∏–≥—Ä–∞—Ü–∏—è —Å inline-—Å—Ç–∏–ª–µ–π –Ω–∞ Tailwind

### –ù–∏–∑–∫–∏–µ (nice to have)

- [ ] **Feature Flags**
  - –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã FeatureFlag
  - –ü—Ä–æ—Å—Ç–æ–π API –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ñ–ª–∞–≥–æ–≤

- [ ] **–ü—Ä–æ–≤–µ—Ä–∫–∞ –±—ç–∫–∞–ø–æ–≤ Neon**
  - –í–∫–ª—é—á–µ–Ω–∏–µ Point-in-Time Recovery
  - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ retention

---

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω–∞

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ
```bash
DATABASE_URL=postgresql://...
TELEGRAM_BOT_TOKEN=...
JWT_SECRET=...
ADMIN_SECRET=...
NEXT_PUBLIC_MINI_APP_URL=https://skinplan-mini.vercel.app
```

### –î–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è (Vercel KV)
```bash
KV_URL=...
KV_REST_API_URL=...
KV_REST_API_TOKEN=...
KV_REST_API_READ_ONLY_TOKEN=...
```

### –î–ª—è rate limiting (Upstash - –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```bash
UPSTASH_REDIS_REST_URL=...
UPSTASH_REDIS_REST_TOKEN=...
```

### –î–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (Sentry - –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```bash
SENTRY_DSN=...
SENTRY_AUTH_TOKEN=...
```

---

## üìä –°—Ç–∞—Ç—É—Å –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

**–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å**: ‚úÖ **80% –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ –ø—Ä–æ–¥–∞–∫—à–Ω—É**

### –ì–æ—Ç–æ–≤–æ:
- ‚úÖ Rate limiting (–±–∞–∑–æ–≤–∞—è –≤–µ—Ä—Å–∏—è)
- ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ (—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≥–æ—Ç–æ–≤–∞, —Ç—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ KV)
- ‚úÖ Error Boundary
- ‚úÖ Toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- ‚úÖ –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ API

### –¢—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è:
- ‚ö†Ô∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Vercel KV –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚ö†Ô∏è –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ Redis-based rate limiting (–¥–ª—è production)
- ‚ö†Ô∏è –ë–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã

---

## üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –¥–µ–ø–ª–æ—é

1. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ Vercel**
   - –í—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ —Å–ø–∏—Å–∫–∞ –≤—ã—à–µ
   - Vercel KV –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ)

2. **–°–æ–∑–¥–∞—Ç—å Vercel KV Database** (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ)
   ```bash
   vercel kv
   ```

3. **–î–µ–ø–ª–æ–π**
   ```bash
   git push origin main
   ```
   Vercel –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–¥–µ–ø–ª–æ–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è.

4. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É rate limiting (—Å–¥–µ–ª–∞—Ç—å 11 –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ `/api/plan/generate`)
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ (–ø–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å –¥–æ–ª–≥–∏–π, –≤—Ç–æ—Ä–æ–π –±—ã—Å—Ç—Ä—ã–π)
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Error Boundary (–µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ, –≤—ã–∑–≤–∞—Ç—å –æ—à–∏–±–∫—É)

---

**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**: 2025-01-27


<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –∫–≤–∏–∑–∞ - –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .screen {
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            margin: 10px 0;
        }
        .button {
            background: #D5FE61;
            color: #000;
            border: none;
            padding: 12px 24px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
            margin: 10px;
        }
        .button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        .log {
            background: #f9f9f9;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
            margin: 10px 0;
            max-height: 200px;
            overflow-y: auto;
        }
        .state {
            background: #e8f4fd;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>–¢–µ—Å—Ç –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –∫–≤–∏–∑–∞</h1>

        <div class="state">
            <h3>–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:</h3>
            <div id="currentState">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
        </div>

        <div class="screen" id="screen">
            <div id="screenContent">–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è...</div>
        </div>

        <div>
            <button class="button" id="continueBtn" onclick="handleContinue()">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
            <button class="button" id="backBtn" onclick="handleBack()" style="background: #eee; color: #666;">–ù–∞–∑–∞–¥</button>
        </div>

        <div class="log">
            <h3>–õ–æ–≥–∏:</h3>
            <div id="logs"></div>
        </div>
    </div>

    <script>
        // –ò–º–∏—Ç–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–≤–∏–∑–∞
        let state = {
            currentInfoScreenIndex: 0,
            viewMode: 'INITIAL_INFO',
            isLoading: false,
            questionnaireLoaded: false,
            questionsLoaded: false,
            initialInfoScreens: [
                { id: 'welcome', title: '–ü–æ–¥–±–µ—Ä–∏ —É—Ö–æ–¥ –¥–ª—è —Å–≤–æ–µ–π –∫–æ–∂–∏ —Å–æ SkinIQ' },
                { id: 'how_it_works', title: '–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?' },
                { id: 'personal_analysis', title: 'SkinIQ ‚Äî –≤–∞—à –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∫–æ–∂–∏' },
                { id: 'goals_intro', title: '–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ –≤–∞—à–µ–π —Ü–µ–ª–∏' }
            ]
        };

        const logs = [];

        function log(message, data = null) {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `${timestamp}: ${message}`;
            logs.push(logEntry);
            if (data) {
                logs.push(`  ${JSON.stringify(data, null, 2)}`);
            }
            updateLogs();
            console.log(message, data);
        }

        function updateLogs() {
            document.getElementById('logs').innerHTML = logs.slice(-20).join('<br>');
        }

        function updateUI() {
            const currentScreen = state.initialInfoScreens[state.currentInfoScreenIndex];
            const isLastScreen = state.currentInfoScreenIndex === state.initialInfoScreens.length - 1;

            document.getElementById('currentState').innerHTML = `
                <strong>currentInfoScreenIndex:</strong> ${state.currentInfoScreenIndex}<br>
                <strong>viewMode:</strong> ${state.viewMode}<br>
                <strong>isLoading:</strong> ${state.isLoading}<br>
                <strong>questionnaireLoaded:</strong> ${state.questionnaireLoaded}<br>
                <strong>questionsLoaded:</strong> ${state.questionsLoaded}<br>
                <strong>currentScreen:</strong> ${currentScreen ? currentScreen.id : 'none'}<br>
                <strong>isLastScreen:</strong> ${isLastScreen}
            `;

            document.getElementById('screenContent').innerHTML = currentScreen ?
                `<h2>${currentScreen.title}</h2>` :
                '<p>–≠–∫—Ä–∞–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω</p>';

            document.getElementById('continueBtn').disabled = state.isLoading;
            document.getElementById('backBtn').disabled = state.currentInfoScreenIndex === 0;
        }

        async function handleContinue() {
            log('üñ±Ô∏è –ö–Ω–æ–ø–∫–∞ "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å" –Ω–∞–∂–∞—Ç–∞', {
                currentInfoScreenIndex: state.currentInfoScreenIndex,
                viewMode: state.viewMode
            });

            if (state.isLoading) {
                log('‚è∏Ô∏è –£–∂–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∑–∞–≥—Ä—É–∑–∫–∞, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º');
                return;
            }

            const initialLen = state.initialInfoScreens.length;

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–∞—Ö–æ–¥–∏–º—Å—è –ª–∏ –º—ã –Ω–∞ –Ω–∞—á–∞–ª—å–Ω—ã—Ö –∏–Ω—Ñ–æ-—ç–∫—Ä–∞–Ω–∞—Ö
            if (state.currentInfoScreenIndex < initialLen - 1) {
                // –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –∏–Ω—Ñ–æ-—ç–∫—Ä–∞–Ω—É
                const newIndex = state.currentInfoScreenIndex + 1;
                log('üîÑ –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –∏–Ω—Ñ–æ-—ç–∫—Ä–∞–Ω—É', {
                    from: state.currentInfoScreenIndex,
                    to: newIndex
                });
                state.currentInfoScreenIndex = newIndex;
                updateUI();
                return;
            }

            // –ú—ã –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–º –Ω–∞—á–∞–ª—å–Ω–æ–º —ç–∫—Ä–∞–Ω–µ - –Ω—É–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤–æ–ø—Ä–æ—Å—ã
            if (state.currentInfoScreenIndex === initialLen - 1) {
                log('üìö –ù–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–º –∏–Ω—Ñ–æ-—ç–∫—Ä–∞–Ω–µ, –Ω–∞—á–∏–Ω–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É –≤–æ–ø—Ä–æ—Å–æ–≤');
                state.isLoading = true;
                updateUI();

                try {
                    // –ò–º–∏—Ç–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –∞–Ω–∫–µ—Ç—ã
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    state.questionnaireLoaded = true;
                    log('‚úÖ –ê–Ω–∫–µ—Ç–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞');

                    // –ò–º–∏—Ç–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤–æ–ø—Ä–æ—Å–æ–≤
                    await new Promise(resolve => setTimeout(resolve, 500));
                    state.questionsLoaded = true;
                    log('‚úÖ –í–æ–ø—Ä–æ—Å—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã');

                    // –ü–µ—Ä–µ—Ö–æ–¥ –∫ –≤–æ–ø—Ä–æ—Å–∞–º
                    state.currentInfoScreenIndex = initialLen;
                    state.viewMode = 'QUESTION';
                    log('üéØ –ü–µ—Ä–µ—Ö–æ–¥ –∫ –≤–æ–ø—Ä–æ—Å–∞–º', {
                        newInfoScreenIndex: state.currentInfoScreenIndex,
                        viewMode: state.viewMode
                    });

                } catch (error) {
                    log('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏', error);
                    state.viewMode = 'ERROR';
                } finally {
                    state.isLoading = false;
                    updateUI();
                }
                return;
            }

            log('‚ö†Ô∏è –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ', state);
        }

        function handleBack() {
            if (state.currentInfoScreenIndex > 0) {
                state.currentInfoScreenIndex--;
                log('‚¨ÖÔ∏è –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞–∑–∞–¥', {
                    newIndex: state.currentInfoScreenIndex
                });
                updateUI();
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        log('üöÄ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ—Å—Ç–∞');
        updateUI();
    </script>
</body>
</html>
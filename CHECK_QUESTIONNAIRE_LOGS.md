# –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –∑–∞–≥—Ä—É–∑–∫–∏ –∞–Ω–∫–µ—Ç—ã

## 1. –ö–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (—Å–∞–º—ã–π –≤–∞–∂–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫)

–õ–æ–≥–∏, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –¥–æ–±–∞–≤–∏–ª–∏, –≤—ã–≤–æ–¥—è—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞. –ß—Ç–æ–±—ã –∏—Ö —É–≤–∏–¥–µ—Ç—å:

1. **–û—Ç–∫—Ä–æ–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å –∞–Ω–∫–µ—Ç–æ–π** (`/quiz`)
2. **–û—Ç–∫—Ä–æ–π—Ç–µ DevTools:**
   - Windows/Linux: `F12` –∏–ª–∏ `Ctrl+Shift+I`
   - Mac: `Cmd+Option+I`
3. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É Console**
4. **–û—á–∏—Å—Ç–∏—Ç–µ –∫–æ–Ω—Å–æ–ª—å** (–∫–Ω–æ–ø–∫–∞ üö´ –∏–ª–∏ `Ctrl+L` / `Cmd+K`)
5. **–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É** (`F5` –∏–ª–∏ `Cmd+R`)

### –ß—Ç–æ –∏—Å–∫–∞—Ç—å –≤ –ª–æ–≥–∞—Ö:

–ò—â–∏—Ç–µ –ª–æ–≥–∏ —Å —Ç–∞–∫–∏–º–∏ –ø—Ä–µ—Ñ–∏–∫—Å–∞–º–∏:
- üîµ `loadQuestionnaire() CALLED` - –Ω–∞—á–∞–ª–æ –∑–∞–≥—Ä—É–∑–∫–∏ –∞–Ω–∫–µ—Ç—ã
- üü¢ `init() CALLING loadQuestionnaire()` - –≤—ã–∑–æ–≤ –∏–∑ init()
- üü¢ `init() loadQuestionnaire() RETURNED` - —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–≥—Ä—É–∑–∫–∏
- ‚úÖ `Questionnaire loaded successfully` - —É—Å–ø–µ—à–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
- ‚úÖ `setQuestionnaire CALLED` - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞–Ω–∫–µ—Ç—ã –≤ state
- ‚ùå `Error loading questionnaire` - –æ—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏
- üîç `RENDER - checking questionnaire state` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–∏ —Ä–µ–Ω–¥–µ—Ä–µ
- ‚ö†Ô∏è `CRITICAL: Questionnaire loaded but loading=true` - –ø—Ä–æ–±–ª–µ–º–∞ —Å loading

### –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –≤ –∫–æ–Ω—Å–æ–ª–∏:

–í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –º–æ–∂–Ω–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏:
- –í–≤–µ–¥–∏—Ç–µ –≤ –ø–æ–ª–µ —Ñ–∏–ª—å—Ç—Ä–∞: `questionnaire` –∏–ª–∏ `loadQuestionnaire` –∏–ª–∏ `init`
- –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ: `/questionnaire|loading|init/`

### –í–∞–∂–Ω—ã–µ –ª–æ–≥–∏ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:

1. **–ù–∞—á–∞–ª–æ –∑–∞–≥—Ä—É–∑–∫–∏:**
   ```
   üîµ loadQuestionnaire() CALLED
   ```

2. **–†–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–≥—Ä—É–∑–∫–∏:**
   ```
   üü¢ init() loadQuestionnaire() RETURNED
   questionnaireId: <id> –∏–ª–∏ null
   ```

3. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤ state:**
   ```
   ‚úÖ setQuestionnaire CALLED
   ‚úÖ setQuestionnaire callback EXECUTED
   ```

4. **–ü—Ä–æ–±–ª–µ–º—ã:**
   ```
   ‚ö†Ô∏è CRITICAL: Questionnaire loaded but loading=true
   ‚ùå Error loading questionnaire
   ```

## 2. Vercel Logs

–ï—Å–ª–∏ –ª–æ–≥–∏ –Ω–µ –≤–∏–¥–Ω—ã –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ Vercel Logs:

1. –ó–∞–π–¥–∏—Ç–µ –≤ [Vercel Dashboard](https://vercel.com/dashboard)
2. –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç `skinplan-mini`
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª **Logs**
4. –§–∏–ª—å—Ç—Ä—É–π—Ç–µ –ø–æ:
   - **Function:** `/api/questionnaire/active`
   - **Level:** `error` –∏–ª–∏ `warn`
   - **Time:** –ø–æ—Å–ª–µ–¥–Ω–∏–µ 1-2 —á–∞—Å–∞

### –ß—Ç–æ –∏—Å–∫–∞—Ç—å –≤ Vercel Logs:

- `GET /api/questionnaire/active` - –∑–∞–ø—Ä–æ—Å—ã –∫ API –∞–Ω–∫–µ—Ç—ã
- `Error fetching active questionnaire` - –æ—à–∏–±–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- `Questionnaire formatted successfully` - —É—Å–ø–µ—à–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞

## 3. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (PostgreSQL)

–õ–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏:
- –ï—Å—Ç—å `userId` (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω)
- –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∞: `error` –∏–ª–∏ `warn` (–∏–ª–∏ —è–≤–Ω–æ —É–∫–∞–∑–∞–Ω–æ `saveToDb: true`)

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç:

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –∑–∞–≥—Ä—É–∑–∫–∏ –∞–Ω–∫–µ—Ç—ã
npx tsx scripts/check-questionnaire-logs.ts

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ –ª–æ–≥–∏
npx tsx scripts/check-recent-logs.ts

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
npx tsx scripts/check-user-logs.ts
```

## 4. KV (Upstash Redis)

–õ–æ–≥–∏ —Ç–∞–∫–∂–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ KV, –Ω–æ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –Ω—É–∂–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å KV –ª–æ–≥–∏
npx tsx scripts/check-kv-logs.ts

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å KV –ª–æ–≥–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
npx tsx scripts/check-user-kv-logs.ts <userId>
```

## 5. –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ –∏—Ö –ª–æ–≥–∏

### –ü—Ä–æ–±–ª–µ–º–∞: –õ–æ–∞–¥–µ—Ä –∑–∞–≤–∏—Å–∞–µ—Ç

**–ò—â–∏—Ç–µ:**
- `loading=true` –Ω–æ `hasQuestionnaire=true`
- `CRITICAL: Questionnaire loaded but loading=true`

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–ª–∂–Ω–æ –±—ã—Ç—å `setLoading(false)` –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –∞–Ω–∫–µ—Ç—ã

### –ü—Ä–æ–±–ª–µ–º–∞: –ê–Ω–∫–µ—Ç–∞ –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è

**–ò—â–∏—Ç–µ:**
- `‚ùå Error loading questionnaire`
- `loadQuestionnaire() RETURNED null`
- `questionnaireRef.current not set after loadQuestionnaire`

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—à–∏–±–∫—É –≤ `error` –∏–ª–∏ `context` –ª–æ–≥–∞

### –ü—Ä–æ–±–ª–µ–º–∞: –ê–Ω–∫–µ—Ç–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞, –Ω–æ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è

**–ò—â–∏—Ç–µ:**
- `hasQuestionnaireRef=true` –Ω–æ `hasQuestionnaireState=false`
- `Questionnaire in ref but not in state`

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ state –∏–∑ ref

## 6. –≠–∫—Å–ø–æ—Ä—Ç –ª–æ–≥–æ–≤ –∏–∑ –∫–æ–Ω—Å–æ–ª–∏

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ª–æ–≥–∏:

1. –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞: –ø—Ä–∞–≤—ã–π –∫–ª–∏–∫ ‚Üí "Save as..."
2. –ò–ª–∏ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤–∞–∂–Ω—ã–µ –ª–æ–≥–∏ –≤ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª
3. –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∏–ª—å—Ç—Ä –∏ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏

## 7. –û—Ç–ª–∞–¥–∫–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

–î–ª—è –æ—Ç–ª–∞–¥–∫–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:

1. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞
2. –û—á–∏—Å—Ç–∏—Ç–µ –ª–æ–≥–∏
3. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É
4. –°–ª–µ–¥–∏—Ç–µ –∑–∞ –ª–æ–≥–∞–º–∏ –ø–æ –º–µ—Ä–µ –∑–∞–≥—Ä—É–∑–∫–∏
5. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –ø–æ—Ä—è–¥–æ–∫ –ª–æ–≥–æ–≤:
   - –°–Ω–∞—á–∞–ª–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `üîµ loadQuestionnaire() CALLED`
   - –ü–æ—Ç–æ–º `üü¢ init() loadQuestionnaire() RETURNED`
   - –ü–æ—Ç–æ–º `‚úÖ setQuestionnaire CALLED`
   - –ü–æ—Ç–æ–º `‚úÖ Questionnaire loaded successfully`
   - –ò –Ω–∞–∫–æ–Ω–µ—Ü `üîç RENDER - checking questionnaire state`

## 8. –ï—Å–ª–∏ –ª–æ–≥–æ–≤ –Ω–µ—Ç –≤–æ–æ–±—â–µ

–ï—Å–ª–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–µ—Ç –ª–æ–≥–æ–≤:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∫–æ–Ω—Å–æ–ª—å –Ω–µ —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç –ª–æ–≥–∏ (—É–±–µ—Ä–∏—Ç–µ –≤—Å–µ —Ñ–∏–ª—å—Ç—Ä—ã)
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (–≤–∫–ª—é—á–∏—Ç–µ –≤—Å–µ —É—Ä–æ–≤–Ω–∏: Verbose, Info, Warnings, Errors)
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è (–º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–µ–¥–∏—Ä–µ–∫—Ç)
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Network tab - –µ—Å—Ç—å –ª–∏ –∑–∞–ø—Ä–æ—Å –∫ `/api/questionnaire/active`

